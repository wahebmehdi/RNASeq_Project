#Setting up libraries
library(DESeq2)
library(ggplot2)
library(pheatmap)
library(EnhancedVolcano)
library(readxl)
#loading up the data
count_data = read_excel("C:\\Users\\mehdi\\Downloads\\GSE242592_COUNT.xlsx")
#Trimming the dataset
#Cleaning the Gene column
count_data$Gene = gsub("^ENSG", "", count_data$Gene)
#Remove the "Name" and "Type" columns
count_data = count_data[, !(names(count_data) %in% c("Name", "Type"))]
#Check for duplicates
sum(duplicated(count_data))
#Checking for missing values
which(is.na(count_data))
#Creation of data-frame for GeneNames
genenames = count_data$Gene
#Creation of count_data
count_data = count_data[,2:7]
rownames(count_data) = genenames
#Changing colnames
coldata = data.frame("condition" = as.factor(c(rep("Inhibitor",3), rep("Control", 3))), row.names = colnames(count_data))
#Checking if the rows of colData and the columns of count_data are in the same order
all(colnames(count_data) == rownames(colData))
#Creating a dds object for DESeqAnalysis
dds = DESeqDataSetFromMatrix(colData = coldata, countData = count_data, design= ~ TRPC6 Inhibitor)
